
CREATE TABLE USERS(
    USER_ID SERIAL PRIMARY KEY,
    USER_NAME VARCHAR(255),
    NAME VARCHAR(255),
    DOB DATE,
    EMAIL VARCHAR(255),
    PHONE VARCHAR(255),
    ADDRESS address_type, 
    AGE INTEGER, 
    FULL_ADDRESS VARCHAR(255) 
        GENERATED ALWAYS AS (
            ADDRESS.city 
            || ', ' 
            || ADDRESS.street 
            || ', ' 
            || ADDRESS.house
        ) STORED
);

CREATE TABLE COMPANY(
    COM_ID SERIAL PRIMARY KEY,
    USER_NAME VARCHAR(255),
    NAME VARCHAR(255),
    IMG VARCHAR(255),
    DESCRIPTION TEXT,
    EMAIL VARCHAR(255)
);

CREATE TABLE MEDIA (
    MEDIA_ID SERIAL PRIMARY KEY,
    TITLE VARCHAR(255),
    DESCRIPTION TEXT,
    RATING INTEGER,
    RATING_COUNT INTEGER,
    TYPE VARCHAR(50),
    GENRE VARCHAR(1000),
    TRAILER VARCHAR(255),
    POSTER VARCHAR(255),
    DURATION VARCHAR(50),
    RELEASE_DATE DATE,
    EPISODE INTEGER,
    CONSTRAINT TYPE_CHECK CHECK (TYPE IN ('MOVIE', 'TV_SHOW', 'DOCUMENTARY', 'ANIME'))
);

CREATE TABLE DISCUSSION(
    DIS_ID SERIAL PRIMARY KEY,
    DESCRIPTION TEXT,
    TOPIC TEXT,
    REPLY_COUNT INTEGER,
    PARENT_TOPIC INTEGER
);

CREATE TABLE LOGIN (
    LOGIN_ID SERIAL PRIMARY KEY,
    PASSWORD VARCHAR(255),
    ROLE VARCHAR(50),
    ID INTEGER,
    CONSTRAINT ROLE_CHECK 
        CHECK (ROLE IN ('ADMIN', 'USER', 'COMPANY'))
);

CREATE TABLE PRODUCTS(
    PRO_ID SERIAL PRIMARY KEY,
    NAME VARCHAR(255),
    DESCRIPTION TEXT,
    IMAGE VARCHAR(255),
    RATING_COUNT INTEGER,
    RATING INTEGER,
    PRICE INTEGER,
    QUANTITY INTEGER
);

CREATE TABLE NEWSANDUPDATES(
    NEWS_ID SERIAL PRIMARY KEY,
    DESCRIPTION TEXT,
    HEADLINE TEXT
);

CREATE TABLE ROLE(
    ROLE_ID SERIAL PRIMARY KEY,
    NAME VARCHAR(255),
    IMG TEXT,
    ROLE_TYPE VARCHAR(255),
    CONSTRAINT ROLE_TYPE_CHECK 
    CHECK (ROLE_TYPE IN (
        'DIRECTOR', 
        'PRODUCER', 
        'WRITER', 
        'ACTOR', 
        'ACTRESS',
        'MUSIC_ARTIST'))
);

CREATE TABLE PREFERREDGENRE(
    USER_ID INTEGER NOT NULL,
    GENRES VARCHAR(1000)
);

CREATE TABLE PREFERENCEFORMEDIA(
    USER_ID INTEGER NOT NULL,
    MEDIA_ID INTEGER NOT NULL,
    CONSTRAINT PREFERENCEFORMEDIA_AK_1 UNIQUE(MEDIA_ID)
);

CREATE TABLE PREFERENCEFORROLE(
    USER_ID INTEGER NOT NULL,
    ROLE_ID INTEGER NOT NULL
);

CREATE TABLE USERWATCHANDFAVORITE (
    USER_ID INTEGER NOT NULL,
    MEDIA_ID INTEGER NOT NULL,
    FAVORITE CHAR(1) CHECK (FAVORITE IN ('Y', 'N')),
    STATUS VARCHAR(50),
    CONSTRAINT USERWATCHANDFAVORITE_AK_1 
        UNIQUE (USER_ID, MEDIA_ID),
    CONSTRAINT STATUS_CHECK     
        CHECK (STATUS IN ('WATCHED', 'PLAN_TO_WATCH'))
);

CREATE TABLE USERSTARTDISCUSSION(
    DIS_ID INTEGER NOT NULL,
    USER_ID INTEGER NOT NULL
);

CREATE TABLE MEDIAHASROLE(
    ROLE_ID INTEGER NOT NULL,
    MEDIA_ID INTEGER NOT NULL
);

CREATE TABLE COMPANYHASMEDIA(
    MEDIA_ID INTEGER NOT NULL,
    COM_ID INTEGER NOT NULL
);

CREATE TABLE COMPANYGIVENEWS (
    NEWS_ID INTEGER NOT NULL,
    COM_ID INTEGER NOT NULL,
    NEWS_DATE DATE,
    PRIMARY KEY (NEWS_ID, COM_ID)
);


CREATE TABLE REVIEWRATING (
    R_ID SERIAL PRIMARY KEY,
    DESCRIPTION TEXT,
    RATING INTEGER,
    REVIEW_FOR VARCHAR(50),
    REVIEW_DATE DATE,
    CONSTRAINT REVIEW_FOR_CHECK CHECK (REVIEW_FOR IN ('PRODUCT', 'MEDIA'))
);

CREATE TABLE USERGIVEREVIEW(
    USER_ID INTEGER NOT NULL,
    R_ID INTEGER NOT NULL
);

CREATE TABLE REVIEWABOUTMEDIA(
    R_ID INTEGER NOT NULL,
    MEDIA_ID INTEGER NOT NULL
    TYPE VARCHAR(50)
);


CREATE TABLE DISCUSSIONABOUTMEDIA (
    DIS_ID INTEGER NOT NULL,
    MEDIA_ID INTEGER NOT NULL,
    DIS_DATE DATE
);

CREATE TABLE NEWSTOMEDIA (
    MEDIA_ID INTEGER NOT NULL,
    NEWS_ID INTEGER NOT NULL,
    NEWS_DATE DATE
);
ALTER TABLE PREFERENCEFORMEDIA 
    ADD CONSTRAINT FK_MEDIA_ID_PREFERENCEFORMEDIA FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID),
    ADD CONSTRAINT FK_USER_ID_PREFERENCEFORMEDIA FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID);

ALTER TABLE PREFERENCEFORROLE 
    ADD CONSTRAINT FK_USER_ID_PREFERENCEFORROLE FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID),
    ADD CONSTRAINT FK_ROLE_ID_PREFERENCEFORROLE FOREIGN KEY (ROLE_ID) REFERENCES ROLE (ROLE_ID);

ALTER TABLE USERWATCHANDFAVORITE 
    ADD CONSTRAINT FK_USER_ID_USERWATCHANDFAVORITE FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID),
    ADD CONSTRAINT FK_MEDIA_ID_USERWATCHANDFAVORITE FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID);

ALTER TABLE USERSTARTDISCUSSION 
    ADD CONSTRAINT FK_DIS_ID_USERSTARTDISCUSSION FOREIGN KEY (DIS_ID) REFERENCES DISCUSSION (DIS_ID),
    ADD CONSTRAINT FK_USER_ID_USERSTARTDISCUSSION FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID);

ALTER TABLE MEDIAHASROLE 
    ADD CONSTRAINT FK_MEDIA_ID_MEDIAHASROLE FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID),
    ADD CONSTRAINT FK_ROLE_ID_MEDIAHASROLE FOREIGN KEY (ROLE_ID) REFERENCES ROLE (ROLE_ID);

ALTER TABLE COMPANYHASMEDIA 
    ADD CONSTRAINT FK_COM_ID_COMPANYHASMEDIA FOREIGN KEY (COM_ID) REFERENCES COMPANY (COM_ID),
    ADD CONSTRAINT FK_MEDIA_ID_COMPANYHASMEDIA FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID);

ALTER TABLE COMPANYGIVENEWS 
    ADD CONSTRAINT FK_COM_ID_COMPANYGIVENEWS FOREIGN KEY (COM_ID) REFERENCES COMPANY (COM_ID),
    ADD CONSTRAINT FK_NEWS_ID_COMPANYGIVENEWS FOREIGN KEY (NEWS_ID) REFERENCES NEWSANDUPDATES (NEWS_ID);

ALTER TABLE USERGIVEREVIEW 
    ADD CONSTRAINT FK_USER_ID_USERGIVEREVIEW FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID),
    ADD CONSTRAINT FK_R_ID_USERGIVEREVIEW FOREIGN KEY (R_ID) REFERENCES REVIEWRATING (R_ID);

ALTER TABLE REVIEWABOUTMEDIA 
    ADD CONSTRAINT FK_R_ID_REVIEWABOUTMEDIA FOREIGN KEY (R_ID) REFERENCES REVIEWRATING (R_ID),
    ADD CONSTRAINT FK_MEDIA_ID_REVIEWABOUTMEDIA FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID);

ALTER TABLE DISCUSSIONABOUTMEDIA 
    ADD CONSTRAINT FK_DIS_ID_DISCUSSIONABOUTMEDIA FOREIGN KEY (DIS_ID) REFERENCES DISCUSSION (DIS_ID),
    ADD CONSTRAINT FK_MEDIA_ID_DISCUSSIONABOUTMEDIA FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID);

ALTER TABLE NEWSTOMEDIA 
    ADD CONSTRAINT FK_NEWS_ID_NEWSTOMEDIA FOREIGN KEY (NEWS_ID) REFERENCES NEWSANDUPDATES (NEWS_ID),
    ADD CONSTRAINT FK_MEDIA_ID_NEWSTOMEDIA FOREIGN KEY (MEDIA_ID) REFERENCES MEDIA (MEDIA_ID);












--user--------------------------------------------------------------------------------------------------------------------------------

INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS) 
            VALUES (1234, 'Siifu', 'Sifat Bin Asad', TO_DATE('01/01/1999', 'MM/DD/YYYY'), 'meow@gmail.com', '01700000000', address_type('Dhaka', 'Dhanmondi', '12'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1234, '1234', 'USER', 1234);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
            VALUES (1234, 'ACTION,ADVENTURE');


-- User 2
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1235, 'AlexR', 'Alexander Red', TO_DATE('03/15/1992', 'MM/DD/YYYY'), 'alexr@gmail.com', '01700000001', address_type('New York', 'Manhattan', '45'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11235, '1234', 'USER', 1235);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1235, 'ADVENTURE,DRAMA,FANTASY');

-- User 3
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1236, 'LaraC', 'Lara Croft', TO_DATE('07/22/1987', 'MM/DD/YYYY'), 'laraC@gmail.com', '01700000002', address_type('London', 'Westminster', '12B'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11236, '1234', 'USER', 1236);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1236, 'ACTION,MYSTERY,THRILLER');

-- User 4
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1237, 'JohnDoe', 'John Doe', TO_DATE('11/05/1995', 'MM/DD/YYYY'), 'johndoe@gmail.com', '01700000003', address_type('San Francisco', 'Market Street', '233'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11237, '1234', 'ADMIN', 1237);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1237, 'HORROR,SCI-FI,THRILLER');

-- User 5
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1238, 'EmilyR', 'Emily Rogers', TO_DATE('08/08/2000', 'MM/DD/YYYY'), 'emilyr@gmail.com', '01700000004', address_type('Toronto', 'Yonge Street', '128'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11238, '1234', 'USER', 1238);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1238, 'COMEDY,ROMANCE,DRAMA');

-- User 6
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1239, 'PeterP', 'Peter Parker', TO_DATE('04/17/1994', 'MM/DD/YYYY'), 'peterp@gmail.com', '01700000005', address_type('New York', 'Queens', '22'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11239, '1234', 'MERCHANDISER', 1239);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1239, 'ACTION,SCI-FI,FANTASY');

-- User 7
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1240, 'MaryJ', 'Mary Jane', TO_DATE('12/12/1996', 'MM/DD/YYYY'), 'maryj@gmail.com', '01700000006', address_type('Los Angeles', 'Sunset Blvd', '56A'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11240, '1234', 'USER', 1240);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1240, 'ROMANCE,COMEDY,TRAGEDY');

-- User 8
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1241, 'ClarkK', 'Clark Kent', TO_DATE('02/29/1988', 'MM/DD/YYYY'), 'clarkk@gmail.com', '01700000007', address_type('Metropolis', 'Broadway', '789'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11241, '1234', 'COMPANY', 1241);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1241, 'ACTION,MAGIC,PSYCHOLOGICAL');

-- User 9
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1242, 'TonyS', 'Tony Stark', TO_DATE('05/29/1975', 'MM/DD/YYYY'), 'tonys@gmail.com', '01700000008', address_type('Malibu', 'Beach Road', '16'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11242, '1234', 'ADMIN', 1242);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1242, 'SCI-FI,THRILLER,SPORTS');

-- User 10
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1243, 'BruceW', 'Bruce Wayne', TO_DATE('09/15/1972', 'MM/DD/YYYY'), 'brucew@gmail.com', '01700000009', address_type('Gotham', 'Wayne Manor', '1'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11243, '1234', 'COMPANY', 1243);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1243, 'THRILLER,DRAMA,MYSTERY');

-- User 11
INSERT INTO USERS (USER_ID, USER_NAME, NAME, DOB, EMAIL, PHONE, ADDRESS)
    VALUES (1244, 'NatashaR', 'Natasha Romanoff', TO_DATE('12/03/1985', 'MM/DD/YYYY'), 'natashar@gmail.com', '01700000010', address_type('Moscow', 'Red Square', '7'));

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
    VALUES (11244, '1234', 'USER', 1244);

INSERT INTO PREFERREDGENRE (USER_ID, GENRES)
    VALUES (1244, 'ACTION,THRILLER,PSYCHOLOGICAL');




--ADMIN--------------------------------------------------------------------------------------------------------------------------------

INSERT INTO ADMIN (ADMIN_ID, USER_NAME, NAME, DOB, EMAIL, CITY, STREET, HOUSE, PHONE) 
            VALUES (1248, 'admin', 'Sifat Bin Asad', TO_DATE('01/01/1999', 'MM/DD/YYYY'), 'meow@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1258, '1234', 'ADMIN', 1248);
            


INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1226, '1234', 'COMPANY', 1);




--MERCHANDISERs--------------------------------------------------------------------------------------------------------------------------------

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1235, 'mer2', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1235, '1234', 'MERCHANDISER', 1235);

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1236, 'mer3', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1236, '1234', 'MERCHANDISER', 1236);

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1237, 'mer4', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1237, '1234', 'MERCHANDISER', 1237);

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1238, 'mer5', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1238, '1234', 'MERCHANDISER', 1238);

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1239, 'mer6', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1239, '1234', 'MERCHANDISER', 1239);

INSERT INTO MERCHANDISER (MER_ID,USER_NAME, NAME, DESCRIPTION, EMAIL, CITY, STREET, HOUSE, PHONE)
            VALUES (1240, 'mer1', 'SIFAT', 'We sell merch', 'chikachika@gmail.com', 'Dhaka', 'Dhanmondi', '12', '01700000000');

INSERT INTO LOGIN (LOGIN_ID, PASSWORD, ROLE, ID)
            VALUES (1240, '1234', 'MERCHANDISER', 1240);


